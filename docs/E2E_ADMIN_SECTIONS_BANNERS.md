# E2E 테스트 문서: 관리자 섹션 및 배너 관리

## 개요

이 문서는 관리자 페이지의 섹션(Sections) 및 배너(Banners) 관리 기능에 대한 End-to-End 테스트 시나리오를 정의합니다.

---

## 테스트 환경

- **Frontend**: http://localhost:3004
- **Backend**: http://localhost:4000
- **테스트 계정**: 관리자 권한(ADMIN role) 필요

---

## 1. 섹션 관리 (Sections)

### 1.1 섹션 목록 조회

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-001 | 섹션 목록 표시 | 관리자 로그인 | 1. `/admin/sections` 접속 | 등록된 섹션 목록이 순서대로 표시됨 |
| SEC-002 | 비로그인 접근 차단 | 로그아웃 상태 | 1. `/admin/sections` 접속 | "관리자 권한이 필요합니다" 메시지 표시 |
| SEC-003 | 일반 사용자 접근 차단 | 일반 사용자 로그인 | 1. `/admin/sections` 접속 | "관리자 권한이 필요합니다" 메시지 표시 |

### 1.2 섹션 생성

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-010 | 새 섹션 추가 | 관리자 로그인 | 1. "새 섹션 추가" 클릭<br>2. 타입 선택 (hero/categories/meetings/featured)<br>3. 제목 입력<br>4. "저장" 클릭 | 새 섹션이 목록에 추가됨 |
| SEC-011 | Hero 섹션 생성 | 관리자 로그인 | 1. 타입: hero 선택<br>2. 제목, 부제목, 버튼 텍스트/링크 입력<br>3. 배경색 설정<br>4. 저장 | Hero 섹션이 생성되고 메인페이지에 반영됨 |
| SEC-012 | 필수 필드 검증 | 관리자 로그인 | 1. "새 섹션 추가" 클릭<br>2. 아무것도 입력하지 않고 저장 | 유효성 검사 오류 표시 |

### 1.3 섹션 수정

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-020 | 섹션 제목 수정 | 기존 섹션 존재 | 1. 섹션 "수정" 클릭<br>2. 제목 변경<br>3. "저장" 클릭 | 제목이 변경되고 메인페이지에 반영됨 |
| SEC-021 | 섹션 비활성화 | 활성 섹션 존재 | 1. 섹션 "수정" 클릭<br>2. "활성화" 체크 해제<br>3. 저장 | 섹션이 메인페이지에서 숨겨짐 |
| SEC-022 | 섹션 활성화 | 비활성 섹션 존재 | 1. 섹션 "수정" 클릭<br>2. "활성화" 체크<br>3. 저장 | 섹션이 메인페이지에 표시됨 |
| SEC-023 | 수정 취소 | 섹션 수정 모드 | 1. 제목 변경<br>2. "취소" 클릭 | 변경사항이 저장되지 않음 |

### 1.4 섹션 순서 변경 (드래그 앤 드롭)

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-030 | 섹션 순서 변경 | 2개 이상 섹션 존재 | 1. 섹션을 드래그하여 다른 위치로 이동 | 순서가 변경되고 메인페이지에 즉시 반영됨 |
| SEC-031 | 첫 번째로 이동 | 마지막 섹션 선택 | 1. 마지막 섹션을 첫 번째로 드래그 | 해당 섹션이 맨 위로 이동됨 |
| SEC-032 | 마지막으로 이동 | 첫 번째 섹션 선택 | 1. 첫 번째 섹션을 마지막으로 드래그 | 해당 섹션이 맨 아래로 이동됨 |

### 1.5 섹션 삭제

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-040 | 섹션 삭제 | 삭제할 섹션 존재 | 1. "삭제" 클릭<br>2. 확인 다이얼로그에서 "확인" | 섹션이 삭제되고 목록에서 사라짐 |
| SEC-041 | 삭제 취소 | 삭제할 섹션 존재 | 1. "삭제" 클릭<br>2. 확인 다이얼로그에서 "취소" | 섹션이 유지됨 |

### 1.6 메인페이지 동기화

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| SEC-050 | 생성 후 메인페이지 반영 | 관리자 로그인 | 1. 새 섹션 생성<br>2. 메인페이지로 이동 (탭 전환) | 새 섹션이 메인페이지에 표시됨 |
| SEC-051 | 수정 후 메인페이지 반영 | 기존 섹션 존재 | 1. 섹션 수정<br>2. 메인페이지 탭 클릭 | 수정 내용이 메인페이지에 반영됨 |
| SEC-052 | 순서 변경 후 메인페이지 반영 | 2개 이상 섹션 존재 | 1. 섹션 순서 변경<br>2. 메인페이지 탭 클릭 | 변경된 순서가 메인페이지에 반영됨 |

---

## 2. 배너 관리 (Banners)

### 2.1 배너 목록 조회

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-001 | 배너 목록 표시 | 관리자 로그인 | 1. `/admin/banners` 접속 | 등록된 배너 목록이 표시됨 |
| BAN-002 | 만료 배너 표시 | 만료된 배너 존재 | 1. `/admin/banners` 접속 | 만료된 배너에 "만료됨" 태그 표시, 투명도 적용 |
| BAN-003 | 비활성 배너 표시 | 비활성 배너 존재 | 1. `/admin/banners` 접속 | 비활성 배너에 "비활성" 태그 표시, 투명도 적용 |
| BAN-004 | 예약 배너 표시 | 시작일이 미래인 배너 | 1. `/admin/banners` 접속 | "예약" 태그가 표시됨 |

### 2.2 배너 생성

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-010 | 이미지 배너 생성 | 관리자 로그인 | 1. "새 배너 추가" 클릭<br>2. 이미지 업로드<br>3. 링크 URL 입력<br>4. 저장 | 배너가 생성되고 캐러셀에 표시됨 |
| BAN-011 | 배경색 배너 생성 | 관리자 로그인 | 1. "새 배너 추가" 클릭<br>2. 배경색 설정<br>3. 제목/부제목 입력<br>4. 저장 | 배경색 배너가 생성됨 |
| BAN-012 | 이미지 압축 확인 | 5MB 이상 이미지 준비 | 1. 큰 이미지 업로드 | 이미지가 자동 압축되어 업로드됨 |
| BAN-013 | 노출 기간 설정 | 관리자 로그인 | 1. 시작일/종료일 설정<br>2. 저장 | 해당 기간에만 배너가 메인에 노출됨 |

### 2.3 배너 수정

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-020 | 배너 이미지 변경 | 기존 배너 존재 | 1. "수정" 클릭<br>2. 새 이미지 업로드<br>3. 저장 | 이미지가 변경되고 메인페이지에 반영됨 |
| BAN-021 | 배너 링크 변경 | 기존 배너 존재 | 1. "수정" 클릭<br>2. 링크 URL 변경<br>3. 저장 | 링크가 변경됨 |
| BAN-022 | 배너 비활성화 | 활성 배너 존재 | 1. "수정" 클릭<br>2. "활성화" 체크 해제<br>3. 저장 | 배너가 캐러셀에서 숨겨짐 |
| BAN-023 | 배너 순서 변경 | 2개 이상 배너 존재 | 1. "수정" 클릭<br>2. 순서 번호 변경<br>3. 저장 | 캐러셀 순서가 변경됨 |
| BAN-024 | 제목/부제목 수정 | 기존 배너 존재 | 1. "수정" 클릭<br>2. 제목/부제목 변경<br>3. 저장 | 텍스트가 변경되고 캐러셀에 반영됨 |

### 2.4 배너 삭제

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-030 | 배너 삭제 | 삭제할 배너 존재 | 1. "삭제" 클릭<br>2. 확인 다이얼로그에서 "확인" | 배너가 삭제되고 캐러셀에서 제거됨 |
| BAN-031 | 삭제 취소 | 삭제할 배너 존재 | 1. "삭제" 클릭<br>2. 확인 다이얼로그에서 "취소" | 배너가 유지됨 |

### 2.5 배너 캐러셀 (메인페이지)

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-040 | 캐러셀 자동 슬라이드 | 2개 이상 활성 배너 | 1. 메인페이지 접속<br>2. 5초 대기 | 자동으로 다음 배너로 전환됨 |
| BAN-041 | 캐러셀 수동 네비게이션 | 2개 이상 활성 배너 | 1. 메인페이지 접속<br>2. 좌/우 화살표 클릭 | 이전/다음 배너로 전환됨 |
| BAN-042 | 인디케이터 클릭 | 3개 이상 활성 배너 | 1. 하단 인디케이터 클릭 | 해당 배너로 즉시 이동 |
| BAN-043 | 배너 클릭 추적 | 링크가 있는 배너 | 1. 배너 클릭 | 클릭 수가 증가하고 링크로 이동 |
| BAN-044 | 빈 배너 처리 | 활성 배너 없음 | 1. 메인페이지 접속 | 캐러셀 영역이 표시되지 않음 |

### 2.6 메인페이지 동기화

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| BAN-050 | 생성 후 메인페이지 반영 | 관리자 로그인 | 1. 새 배너 생성<br>2. 메인페이지 탭 클릭 | 새 배너가 캐러셀에 표시됨 |
| BAN-051 | 수정 후 메인페이지 반영 | 기존 배너 존재 | 1. 배너 이미지 변경<br>2. 메인페이지 탭 클릭 | 변경된 이미지가 캐러셀에 표시됨 |
| BAN-052 | 삭제 후 메인페이지 반영 | 2개 이상 배너 존재 | 1. 배너 삭제<br>2. 메인페이지 탭 클릭 | 삭제된 배너가 캐러셀에서 제거됨 |

---

## 3. 공통 테스트

### 3.1 인증/권한

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| COM-001 | 토큰 만료 처리 | 세션 만료 | 1. 섹션/배너 수정 시도 | 로그인 페이지로 리다이렉트 |
| COM-002 | 권한 변경 처리 | 관리자 → 일반 사용자로 변경 | 1. 관리자 페이지 새로고침 | 권한 오류 메시지 표시 |

### 3.2 네트워크/에러 처리

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| COM-010 | 네트워크 오류 | 백엔드 서버 중단 | 1. 섹션/배너 저장 시도 | 에러 메시지 표시, 데이터 유지 |
| COM-011 | 서버 500 에러 | 서버 에러 상황 | 1. API 호출 | 적절한 에러 메시지 표시 |

### 3.3 UI/UX

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 기대 결과 |
|----|-------------|----------|-----------|----------|
| COM-020 | 로딩 상태 표시 | - | 1. 데이터 로드 중 | "로딩 중..." 표시 |
| COM-021 | 저장 중 버튼 비활성화 | 저장 버튼 클릭 | 1. 저장 진행 중 | 버튼에 "저장 중..." 표시, 클릭 불가 |
| COM-022 | 모바일 반응형 | 모바일 화면 크기 | 1. 관리자 페이지 접속 | 모바일 사이드바 정상 작동 |

---

## 4. API 엔드포인트 참조

### 섹션 API

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/admin/page-sections` | 관리자용 섹션 목록 |
| GET | `/api/admin/public/sections` | 공개용 섹션 목록 |
| POST | `/api/admin/page-sections` | 섹션 생성 |
| PUT | `/api/admin/page-sections/:id` | 섹션 수정 |
| PUT | `/api/admin/page-sections/reorder` | 섹션 순서 변경 |
| DELETE | `/api/admin/page-sections/:id` | 섹션 삭제 |

### 배너 API

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/admin/banners` | 관리자용 배너 목록 |
| GET | `/api/admin/public/banners` | 공개용 배너 목록 |
| POST | `/api/admin/banners` | 배너 생성 |
| PUT | `/api/admin/banners/:id` | 배너 수정 |
| DELETE | `/api/admin/banners/:id` | 배너 삭제 |
| POST | `/api/admin/public/banners/:id/click` | 배너 클릭 추적 |

---

## 5. 알려진 이슈 및 해결 방법

### 5.1 캐시 동기화 이슈

**문제**: 관리자 페이지에서 수정 후 메인페이지에 즉시 반영되지 않음

**원인**:
- React Query의 `refetchOnWindowFocus`가 `false`로 설정되어 있었음
- 관리자 페이지와 메인 페이지가 다른 탭인 경우 캐시가 공유되지 않음

**해결**:
1. `refetchOnWindowFocus: true` 설정 (탭 전환 시 자동 새로고침)
2. `staleTime: 30초`로 단축
3. 관리자 페이지에서 수정 시 `public` 쿼리 키도 함께 무효화

### 5.2 이미지 업로드 크기 이슈

**문제**: 큰 이미지 업로드 시 성능 저하 및 저장 용량 문제

**해결**: `browser-image-compression` 라이브러리를 사용한 클라이언트 측 이미지 압축
- 최대 파일 크기: 1MB
- 최대 해상도: 1920x1080

---

## 6. 테스트 실행 체크리스트

### 사전 준비
- [ ] 백엔드 서버 실행 (http://localhost:4000)
- [ ] 프론트엔드 서버 실행 (http://localhost:3004)
- [ ] 관리자 계정으로 로그인
- [ ] 테스트용 이미지 파일 준비 (다양한 크기)

### 섹션 테스트
- [ ] SEC-001 ~ SEC-003: 목록 조회 및 권한 검증
- [ ] SEC-010 ~ SEC-012: 섹션 생성
- [ ] SEC-020 ~ SEC-023: 섹션 수정
- [ ] SEC-030 ~ SEC-032: 드래그 앤 드롭 순서 변경
- [ ] SEC-040 ~ SEC-041: 섹션 삭제
- [ ] SEC-050 ~ SEC-052: 메인페이지 동기화

### 배너 테스트
- [ ] BAN-001 ~ BAN-004: 목록 조회 및 상태 표시
- [ ] BAN-010 ~ BAN-013: 배너 생성
- [ ] BAN-020 ~ BAN-024: 배너 수정
- [ ] BAN-030 ~ BAN-031: 배너 삭제
- [ ] BAN-040 ~ BAN-044: 캐러셀 기능
- [ ] BAN-050 ~ BAN-052: 메인페이지 동기화

### 공통 테스트
- [ ] COM-001 ~ COM-002: 인증/권한
- [ ] COM-010 ~ COM-011: 에러 처리
- [ ] COM-020 ~ COM-022: UI/UX

---

## 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 2025-12-09 | 1.0 | 초안 작성 | Claude |
