# 소모임 플랫폼 (Sommoim) - PRD v3.5

**작성일:** 2025-12-04
**버전:** 3.5
**상태:** 개발 진행 중 (Phase 1-6 완료)

---

## 1. 프로젝트 개요

### 1.1 기본 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | Sommoim (소모임) |
| 목표 | 관심사 기반 소모임 생성/참가 플랫폼 |
| 타겟 | 20-40대 취미/관심사 기반 모임 참여자 |
| 플랫폼 | 웹 중심 MVP (모바일 반응형) |
| 출시 목표 | 2025년 2월 |

### 1.2 핵심 가치

| 가치 | 설명 |
|------|------|
| 참여 | 모임 생성/검색/참가/일정 관리를 한 곳에서 |
| 신뢰 | 평점/리뷰/신고/차단으로 안전한 커뮤니티 |
| 소통 | 웹 내 실시간 채팅으로 즉시 소통 |
| 운영 | 관리자가 코드 배포 없이 섹션/배너/카테고리 제어 |

### 1.3 사업 목표 (3개월)

| 지표 | 목표 |
|------|------|
| 가입자 | 5,000명 |
| 활성 사용자 | 1,000명/월 |
| 모임 생성 | 500개 |
| 월 참여 | 10,000명 |
| 평점 | 4.5/5 이상 |
| 신고율 | 2% 미만 |
| 가용성 | 99.9% |
| API 응답 | 500ms 이내 |

---

## 2. 사용자 페르소나

### 2.1 일반 사용자 - 김민수 (28세, 직장인)

**배경:**
- 주말 등산 모임을 찾고 있음
- 신뢰할 수 있는 모임 원함
- 일정 변경 알림 필요

**니즈:**
- 관심사 기반 모임 검색
- 모임 평점/리뷰 확인
- 일정 변경 실시간 알림

**Pain Points:**
- 기존 플랫폼은 신뢰성 부족
- 일정 변경 알림이 늦음

### 2.2 모임 주최자 - 이수진 (35세, 프리랜서)

**배경:**
- 독서 모임을 직접 운영하고 싶음
- 정기 모임 일정 관리 필요
- 참가자 관리 기능 필요

**니즈:**
- 간편한 모임 생성
- 참가 신청 승인/거절
- 다중 일정 관리
- 참가자와 채팅

**Pain Points:**
- 참가자 관리가 번거로움
- 일정 공지가 어려움

### 2.3 관리자 - 박지훈

**배경:**
- 신고 처리, 콘텐츠 관리 담당
- 대시보드로 현황 파악 필요
- 배너/섹션 직접 수정 필요

**니즈:**
- 실시간 대시보드
- 신고 처리 워크플로우
- 콘텐츠 관리 (배너, 섹션, 카테고리)

---

## 3. 기능 명세

### 3.1 인증 & 사용자

#### 3.1.1 회원가입/로그인

| 기능 | 설명 | 우선순위 | 상태 |
|------|------|----------|------|
| 이메일 가입 | 이메일 + 비밀번호 | P0 | ✅ 완료 |
| 비밀번호 정책 | 8자+, 대소문자/숫자/특수문자 | P0 | ✅ 완료 |
| JWT 인증 | Access 24h, Refresh 7d | P0 | ✅ 완료 |
| httpOnly 쿠키 | XSS/CSRF 방어 | P0 | ✅ 완료 |
| 이메일 인증 | 가입 시 인증 메일 발송 | P1 | 🔜 예정 |
| 비밀번호 재설정 | 이메일로 재설정 링크 | P1 | 🔜 예정 |

#### 3.1.2 프로필

| 기능 | 설명 | 우선순위 | 상태 |
|------|------|----------|------|
| 기본 정보 | 닉네임, 자기소개 | P0 | ✅ 완료 |
| 프로필 사진 | Cloudflare R2 저장 | P0 | ✅ 완료 |
| 프로필 수정 | 닉네임, 소개, 사진 수정 | P0 | ✅ 완료 |
| 얼굴 사진 | 선택, 모임주가 참가자 확인용 | P1 | 🔜 예정 |
| 팔로우/팔로잉 | 관심 사용자 팔로우 | P2 | 🔜 예정 |

### 3.2 모임

#### 3.2.1 CRUD

| 기능 | 설명 | 권한 | 우선순위 | 상태 |
|------|------|------|----------|------|
| 생성 | 제목/설명/카테고리/지역/최대인원/이미지 | 로그인 사용자 | P0 | ✅ 완료 |
| 조회 | 목록(필터링), 상세 | 모든 사용자 | P0 | ✅ 완료 |
| 수정 | 모임 정보 수정 | 모임주 | P0 | ✅ 완료 |
| 삭제 | 소프트 삭제 | 모임주 | P0 | ✅ 완료 |
| 취소 | 모임 취소 (참가자 알림) | 모임주 | P0 | ✅ 완료 |

#### 3.2.2 검색 & 필터

| 필터 | 옵션 | 상태 |
|------|------|------|
| 카테고리 | 운동, 게임, 음식, 문화, 여행, 학습 | ✅ 완료 |
| 지역 | 서울, 경기, 인천, 부산 등 | ✅ 완료 |
| 날짜 | 오늘, 이번 주, 이번 달, 직접 선택 | ✅ 완료 |
| 상태 | 모집중, 진행중, 완료 | ✅ 완료 |
| 정렬 | 최신순, 인기순, 평점순, 마감임박순 | ✅ 완료 |

#### 3.2.3 일정 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 다중 일정 | 하나의 모임에 여러 일정 추가 가능 | ✅ 완료 |
| 일정 CRUD | 추가/수정/삭제 | ✅ 완료 |
| 상태 자동화 | RECRUITING → ONGOING → COMPLETED | ✅ 완료 |
| 리마인더 | 일정 1시간 전 알림 | 🔜 예정 |

#### 3.2.4 활동 기록

| 기능 | 설명 | 상태 |
|------|------|------|
| 활동 생성 | 제목, 설명, 날짜, 장소 | ✅ 완료 |
| 활동 이미지 | 여러 장 업로드 가능 | ✅ 완료 |
| 이미지 갤러리 | 모달 뷰어, 네비게이션 | ✅ 완료 |
| 활동 삭제 | 모임주만 가능 | ✅ 완료 |

### 3.3 참가 & 승인

#### 3.3.1 기능

| 기능 | 설명 | 상태 |
|------|------|------|
| 신청 | 모임 참가 신청 | ✅ 완료 |
| 자동 승인 | 모임주가 설정 가능 | ✅ 완료 |
| 승인/거절 | 모임주가 처리 | ✅ 완료 |
| 신청 취소 | PENDING 상태에서 취소 | ✅ 완료 |
| 탈퇴 | APPROVED 상태에서 탈퇴 (사유 입력 가능) | ✅ 완료 |
| 강퇴 | 모임주가 참가자 강퇴 | ✅ 완료 |

### 3.4 리뷰 & 평점

| 기능 | 설명 | 조건 | 상태 |
|------|------|------|------|
| 리뷰 작성 | 별점(1-5) + 텍스트 | 모임 완료 후 참가자만 | ✅ 완료 |
| 리뷰 수정 | 본인 리뷰만 | 작성자 | ✅ 완료 |
| 리뷰 삭제 | 본인 리뷰만 | 작성자 | ✅ 완료 |
| 평균 평점 | 모임별 평균 표시 | - | ✅ 완료 |

### 3.5 신고 & 차단

#### 3.5.1 신고

| 대상 | 사유 | 상태 |
|------|------|------|
| 모임 신고 | 스팸, 부적절한 콘텐츠, 불법 거래 | ✅ 완료 |
| 사용자 신고 | 괴롭힘, 사기, 명예훼손 | ✅ 완료 |

#### 3.5.2 차단

| 기능 | 효과 | 상태 |
|------|------|------|
| 사용자 차단 | 차단 대상과 채팅/모임 불가 | ✅ 완료 |
| 차단 해제 | 언제든 해제 가능 | ✅ 완료 |
| 차단 목록 | 차단한 사용자 목록 조회 | ✅ 완료 |

### 3.6 알림

#### 3.6.1 알림 유형

| 유형 | 트리거 | 중요도 | 상태 |
|------|--------|--------|------|
| 참가 승인 | 모임주가 승인 시 | HIGH | ✅ 완료 |
| 참가 거절 | 모임주가 거절 시 | HIGH | ✅ 완료 |
| 새 참가 신청 | 수동 승인 모임에 신청 시 | HIGH | ✅ 완료 |
| 멤버 탈퇴 | 참가자가 탈퇴 시 | NORMAL | ✅ 완료 |
| 일정 변경 | 모임 일정 수정 시 | HIGH | ✅ 완료 |
| 리마인더 | 일정 1시간 전 | NORMAL | 🔜 예정 |
| 새 리뷰 | 내 모임에 리뷰 작성 시 | NORMAL | ✅ 완료 |
| 모임 취소 | 모임이 취소될 때 | CRITICAL | ✅ 완료 |

#### 3.6.2 알림 UI

| 기능 | 설명 | 상태 |
|------|------|------|
| 헤더 알림 아이콘 | 읽지 않은 알림 개수 배지 | ✅ 완료 |
| 알림 드롭다운 | 클릭 시 최근 알림 5개 표시 | ✅ 완료 |
| 자동 새로고침 | 30초마다 알림 폴링 | ✅ 완료 |
| 알림 페이지 | 전체 알림 목록 조회 | ✅ 완료 |

### 3.7 채팅

| 기능 | 설명 | 상태 |
|------|------|------|
| 모임별 채팅방 | 모임 참가자만 접근 | ✅ 완료 |
| 실시간 메시지 | Socket.IO 기반 | ✅ 완료 |
| 메시지 저장 | DB에 영구 저장 | ✅ 완료 |
| 메시지 삭제 | 작성자/관리자만 | ✅ 완료 |

### 3.8 관리자

#### 3.8.1 대시보드

| 지표 | 설명 | 상태 |
|------|------|------|
| 사용자 통계 | 가입자, 활성 사용자 | ✅ 완료 |
| 모임 통계 | 생성, 참여, 완료 | ✅ 완료 |
| 신고 현황 | 대기중, 처리완료 | ✅ 완료 |

#### 3.8.2 섹션 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 섹션 CRUD | Hero, Featured, Categories 등 | ✅ 완료 |
| 드래그 정렬 | 순서 변경 | ✅ 완료 |
| 활성화/비활성화 | 노출 제어 | ✅ 완료 |
| 히어로 색상/이미지 | 그라데이션 색상, 배경 이미지 설정 | ✅ 완료 |

#### 3.8.3 배너 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 배너 CRUD | 이미지, 링크, 순서 | ✅ 완료 |
| 노출 기간 | 시작/종료일 설정 | ✅ 완료 |
| 클릭 통계 | 클릭 수 추적 | ✅ 완료 |

#### 3.8.4 카테고리 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 카테고리 CRUD | 이름, 아이콘, 색상 | ✅ 완료 |
| 정렬 순서 | 표시 순서 설정 | ✅ 완료 |
| 활성화 | 노출 제어 | ✅ 완료 |

#### 3.8.5 사용자/모임 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 사용자 목록 | 검색, 페이지네이션 | ✅ 완료 |
| 역할 변경 | USER/MODERATOR/ADMIN | ✅ 완료 |
| 사용자 삭제 | 소프트 삭제 | ✅ 완료 |
| 모임 목록 | 상태별 필터링 | ✅ 완료 |
| 모임 삭제 | 소프트 삭제 | ✅ 완료 |

#### 3.8.6 신고 관리

| 기능 | 설명 | 상태 |
|------|------|------|
| 신고 목록 | 상태별 필터링 | ✅ 완료 |
| 신고 처리 | 상태 변경 | ✅ 완료 |

---

## 4. 화면 구성

### 4.1 페이지 목록

```
/                           - 홈 (배너, 카테고리, 추천 모임) ✅
├── /login                  - 로그인 ✅
├── /register               - 회원가입 ✅
├── /forgot-password        - 비밀번호 찾기 🔜
│
├── /meetings               - 모임 목록 ✅
│   ├── /create             - 모임 생성 ✅
│   └── /[id]               - 모임 상세 (탭: 정보/활동/리뷰) ✅
│       ├── /edit           - 모임 수정 ✅
│       └── /chat           - 모임 채팅 ✅
│
├── /profile                - 내 프로필 ✅
│   ├── /edit               - 프로필 수정 ✅
│   └── /[id]               - 타인 프로필 ✅
│
├── /notifications          - 알림 ✅
├── /bookmarks              - 북마크 ✅
│
└── /admin                  - 관리자 대시보드 ✅
    ├── /sections           - 섹션 관리 ✅
    ├── /banners            - 배너 관리 ✅
    ├── /categories         - 카테고리 관리 ✅
    ├── /reports            - 신고 관리 ✅
    ├── /users              - 사용자 관리 ✅
    └── /meetings           - 모임 관리 ✅
```

### 4.2 주요 화면 설명

#### 4.2.1 홈 (/)

- 관리자 배너 표시 (최대 3개)
- 관리자 카테고리 또는 기본 카테고리
- 인기 모임 섹션
- 최신 모임 섹션
- CTA 섹션

#### 4.2.2 모임 목록 (/meetings)

- 필터 사이드바 (카테고리, 지역, 날짜)
- 정렬 옵션
- 모임 카드 그리드
- 페이지네이션

#### 4.2.3 모임 상세 (/meetings/[id])

- 탭 네비게이션: 모임 정보 / 활동 기록 / 리뷰
- 모임 이미지 및 기본 정보
- 일정 목록
- 참가자 목록
- 참가 신청/채팅 버튼
- 활동 기록 (이미지 갤러리 포함)

---

## 5. 비기능 요구사항

### 5.1 성능

| 항목 | 목표 |
|------|------|
| API 응답 시간 | 500ms 이내 |
| 페이지 로드 | 3초 이내 |
| 동시 접속자 | 1,000명 |

### 5.2 가용성

| 항목 | 목표 |
|------|------|
| 서비스 가용성 | 99.9% |
| 장애 복구 시간 | 1시간 이내 |

### 5.3 보안

- OWASP Top 10 대응
- 개인정보보호법 준수
- HTTPS 필수

---

## 6. 개발 진행 현황

### 6.1 완료된 기능

| Phase | 기능 | 상태 | 완료일 |
|-------|------|------|--------|
| 1 | NestJS 백엔드 초기화 | ✅ 완료 | 2025-12-03 |
| 1 | Prisma 스키마 (19개 모델) | ✅ 완료 | 2025-12-03 |
| 1 | Next.js 프론트엔드 초기화 | ✅ 완료 | 2025-12-03 |
| 1 | Auth 모듈 (JWT, httpOnly 쿠키) | ✅ 완료 | 2025-12-03 |
| 2 | 모임 CRUD | ✅ 완료 | 2025-12-03 |
| 2 | 검색 & 필터링 | ✅ 완료 | 2025-12-03 |
| 2 | 참가 신청/승인/강퇴 | ✅ 완료 | 2025-12-03 |
| 2 | 파일 업로드 | ✅ 완료 | 2025-12-03 |
| 3 | 일정 관리 | ✅ 완료 | 2025-12-03 |
| 3 | 알림 시스템 | ✅ 완료 | 2025-12-03 |
| 3 | 리뷰/평점 | ✅ 완료 | 2025-12-03 |
| 3 | 신고/차단 | ✅ 완료 | 2025-12-03 |
| 4 | 관리자 대시보드 | ✅ 완료 | 2025-12-03 |
| 4 | 섹션/배너/카테고리 관리 | ✅ 완료 | 2025-12-03 |
| 4 | 사용자/모임/신고 관리 | ✅ 완료 | 2025-12-03 |
| 4 | 공개 API (배너/카테고리 연동) | ✅ 완료 | 2025-12-03 |
| 5 | Socket.IO 채팅 | ✅ 완료 | 2025-12-03 |
| - | 모임 활동 기록/갤러리 | ✅ 완료 | 2025-12-03 |
| - | 프로필 수정 | ✅ 완료 | 2025-12-03 |
| - | 북마크 페이지 | ✅ 완료 | 2025-12-03 |
| - | 활동 출석체크/캘린더 | ✅ 완료 | 2025-12-04 |
| - | 관리자 히어로 색상/이미지 편집 | ✅ 완료 | 2025-12-04 |
| - | 드래그앤드롭 이미지 업로더 | ✅ 완료 | 2025-12-04 |
| - | 관리자 초기 시드 데이터 (섹션/배너) | ✅ 완료 | 2025-12-04 |
| - | 모임 탈퇴 기능 (사유 입력) | ✅ 완료 | 2025-12-04 |
| - | 헤더 알림 드롭다운 | ✅ 완료 | 2025-12-04 |
| - | 알림 자동 폴링 (30초) | ✅ 완료 | 2025-12-04 |

### 6.2 구현된 API

#### 인증 API (5개)
```
POST   /api/auth/register   ✅ 회원가입
POST   /api/auth/login      ✅ 로그인 (httpOnly 쿠키)
POST   /api/auth/logout     ✅ 로그아웃 (토큰 블랙리스트)
POST   /api/auth/refresh    ✅ 토큰 갱신
GET    /api/auth/me         ✅ 내 정보 조회
```

#### 모임 API (13개)
```
POST   /api/meetings              ✅ 모임 생성
GET    /api/meetings              ✅ 모임 목록
GET    /api/meetings/:id          ✅ 모임 상세
PUT    /api/meetings/:id          ✅ 모임 수정
DELETE /api/meetings/:id          ✅ 모임 삭제
POST   /api/meetings/:id/cancel   ✅ 모임 취소
POST   /api/meetings/:id/schedules     ✅ 일정 추가
PUT    /api/meetings/schedules/:sid    ✅ 일정 수정
DELETE /api/meetings/schedules/:sid    ✅ 일정 삭제
POST   /api/meetings/:id/bookmark      ✅ 북마크 추가
DELETE /api/meetings/:id/bookmark      ✅ 북마크 제거
GET    /api/meetings/:id/activities    ✅ 활동 목록
POST   /api/meetings/:id/activities    ✅ 활동 생성
```

#### 참가자 API (7개)
```
POST   /api/meetings/:id/participants          ✅ 참가 신청
GET    /api/meetings/:id/participants          ✅ 참가자 목록
PUT    /api/meetings/:id/participants/:pid     ✅ 상태 변경 (승인/거절/강퇴)
DELETE /api/meetings/:id/participants/me       ✅ 신청 취소
POST   /api/meetings/:id/participants/withdraw ✅ 탈퇴 (사유 입력 가능)
GET    /api/users/me/participations            ✅ 내 참가 모임 목록
```

#### 리뷰 API (4개)
```
POST   /api/meetings/:id/reviews  ✅ 리뷰 작성
GET    /api/meetings/:id/reviews  ✅ 리뷰 목록
PUT    /api/reviews/:id           ✅ 리뷰 수정
DELETE /api/reviews/:id           ✅ 리뷰 삭제
```

#### 알림 API (5개)
```
GET    /api/notifications              ✅ 알림 목록 (페이지네이션)
GET    /api/notifications/unread       ✅ 읽지 않은 알림
PUT    /api/notifications/:id/read     ✅ 읽음 표시
PUT    /api/notifications/read-all     ✅ 모두 읽음
DELETE /api/notifications/:id          ✅ 알림 삭제
```

#### 신고/차단 API (4개)
```
POST   /api/reports          ✅ 신고하기
POST   /api/users/:id/block  ✅ 사용자 차단
DELETE /api/users/:id/block  ✅ 차단 해제
GET    /api/users/me/blocked ✅ 차단 목록
```

#### 채팅 API (3개 + WebSocket)
```
GET    /api/meetings/:id/chats  ✅ 메시지 조회
POST   /api/meetings/:id/chats  ✅ 메시지 전송
DELETE /api/chats/:messageId    ✅ 메시지 삭제
```

#### 관리자 API (17개)
```
GET    /api/admin/dashboard            ✅ 대시보드
GET    /api/admin/page-sections        ✅ 섹션 목록
POST   /api/admin/page-sections        ✅ 섹션 생성
PUT    /api/admin/page-sections/:id    ✅ 섹션 수정
DELETE /api/admin/page-sections/:id    ✅ 섹션 삭제
PUT    /api/admin/page-sections/reorder ✅ 섹션 정렬
GET    /api/admin/banners              ✅ 배너 목록
POST   /api/admin/banners              ✅ 배너 생성
PUT    /api/admin/banners/:id          ✅ 배너 수정
DELETE /api/admin/banners/:id          ✅ 배너 삭제
GET    /api/admin/categories           ✅ 카테고리 목록
POST   /api/admin/categories           ✅ 카테고리 생성
PUT    /api/admin/categories/:id       ✅ 카테고리 수정
DELETE /api/admin/categories/:id       ✅ 카테고리 삭제
GET    /api/admin/users                ✅ 사용자 목록
PUT    /api/admin/users/:id/role       ✅ 역할 변경
DELETE /api/admin/users/:id            ✅ 사용자 삭제
```

#### 공개 API (3개)
```
GET    /api/admin/public/sections      ✅ 활성 섹션
GET    /api/admin/public/banners       ✅ 활성 배너
GET    /api/admin/public/categories    ✅ 활성 카테고리
```

### 6.3 다음 단계

| 기능 | 우선순위 | 상태 |
|------|----------|------|
| 이메일 인증 | P1 | 🔜 예정 |
| 비밀번호 재설정 | P1 | 🔜 예정 |
| 일정 리마인더 | P1 | 🔜 예정 |
| 성능 최적화 | P1 | 🔜 예정 |
| 테스트 작성 | P1 | 🔜 예정 |
| 배포 | P0 | 🔜 예정 |

---

## 7. 용어 정의

| 용어 | 정의 |
|------|------|
| 모임주 (Host) | 모임을 생성한 사용자 |
| 참가자 (Participant) | 모임에 참가 신청한/승인된 사용자 |
| 섹션 (Section) | 홈페이지의 콘텐츠 영역 |
| 배너 (Banner) | 광고/공지용 이미지 |
| 활동 (Activity) | 모임에서 진행한 활동 기록 |

---

**관련 문서:**
- [TRD.md](./TRD.md) - 기술 요구사항
- [SECURITY.md](./SECURITY.md) - 보안 정책
